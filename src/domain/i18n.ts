export type Language = "zh" | "en";

const zh = {
    headerFont: "字体构建",
    headerImage: "图像工具",
    headerSine: "正弦波生成",
    headerSevenSeg: "数码管工具",
    menuFont: "字体",
    menuImage: "图像",
    menuSine: "正弦",
    menuSevenSeg: "数码管",
    loading: "加载中...",
    imageTodo: "图像工具即将到来。",
    sineTodo: "正弦波生成器即将到来。",
    sevenSegTodo: "数码管工具即将到来。",
    saveSettingsTitle: "保存设置",
    saveSettingsConfigName: "配置名",
    saveSettingsConfigNameRequired: "请输入配置名",
    saveSettingsSaveDir: "保存路径",
    saveSettingsChoose: "选择",
    saveSettingsRememberPath: "记住路径",
    saveSettingsIncludeOptions: "包含生成选项",
    saveSettingsOk: "确定",
    saveSettingsCancel: "取消",
    saveSettingsSuccess: "保存成功",
    saveSettingsFail: "保存失败：{msg}",
    saveSettingsUiSection: "界面设置",
    saveSettingsTheme: "主题",
    saveSettingsThemeLight: "浅色",
    saveSettingsThemeDark: "深色",
    saveSettingsLanguage: "语言",
    languageZh: "中文",
    languageEn: "English",
    generatePreview: "生成预览",
    copy: "复制",
    save: "保存",
    copySuccess: "已复制到剪贴板",
    saveSuccess: "已保存：{path}",
    loadFailed: "加载失败：{msg}",
    statusLabel: "状态",
    statusIdle: "空闲",
    statusGenerating: "生成中",
    statusSuccess: "成功",
    statusError: "错误",
    statsGlyphs: "字形数",
    statsRanges: "范围数",
    statsBitmapBytes: "位图字节数",
    statsTextBytes: "文本字节数",
    statsMaxW: "最大宽度",
    statsMaxH: "最大高度",
    statsLineHeight: "行高",
    statsBaseline: "基线",
    statsNoOutput: "暂无输出",
    statsEmpty: "尚无统计信息（先生成预览）",
    statsWarnings: "警告",
    tabPreview: "预览",
    tabCode: "代码",
    tabStats: "统计",
    leftFontSelect: "选择字体",
    leftCharset: "字符集",
    leftSize: "字号与像素参考",
    leftProcessing: "处理效果",
    leftOutput: "生成选项",
    fontSource: "字体来源",
    fontSourceSystem: "系统字体",
    fontSourceFile: "字体文件",
    systemFontLabel: "系统字体",
    systemFontLoading: "加载中...",
    systemFontSelect: "选择系统字体",
    systemFontHint: "枚举系统字体（按名称显示，内部使用字体文件路径）。",
    filePathLabel: "文件路径",
    filePathPlaceholder: "选择 .ttf/.otf 文件",
    chooseFile: "选择文件",
    sizeLabel: "字号（像素高度）",
    sizeHint: "像素参考（示例）：5x7 常见字号约 8；8x16 常见字号约 16（后续可做更智能提示）",
    sizeLineHeight: "行高",
    sizeBaseline: "基线",
    processBinarizeMode: "二值化模式",
    processModeMask: "Python 风格（1-bit mask）",
    processModeGamma: "Gamma + Oversample",
    processThreshold: "灰度过滤强度",
    processAdvanced: "高级（Gamma / Oversample）",
    processGamma: "Gamma",
    processOversample: "Oversample",
    outputType: "输出类型",
    outputCppModule: "C++20 Module（cppm）",
    outputCppTodo: "C++（TODO）",
    outputCTodo: "C（TODO）",
    moduleNameLabel: "模块名（module name）",
    exportNameLabel: "导出字体对象名（export name）",
    applySuggestedNames: "按当前字体字号生成默认命名",
    withCommentsLabel: "生成注释（如 // code 33 ('!')）",
    numberFormatLabel: "点阵数据格式：",
    numberFormatBin: "二进制",
    numberFormatDec: "十进制",
    numberFormatHex: "十六进制",
    charsetRangeLabel: "字符范围（单字符）",
    charsetTo: "到",
    charsetCodepointRange: "码点：{start} - {end}",
    charsetCustomLabel: "自定义字符（会与范围合并、去重）",
    charsetCustomPlaceholder: "例如：℃★你好",
    charsetFallbackLabel: "Fallback 字符（缺字时使用）",
    charsetTodo: "TODO：显示最终字符集数量、重复字符提示、码点列表视图",
    previewScaleLabel: "缩放",
    previewEmpty: "尚无预览",
    previewRaw: "原始",
    previewGray: "灰度",
    previewMono: "二值",
    codePreviewPlaceholder: "// 点击“生成预览”后在此显示生成结果。",
    dotMatrixTodoTitle: "TODO：点阵渲染器",
    mockWarning: "点阵预览未实现（TODO）",
    validateSystemFont: "请选择系统字体。",
    validateFontFile: "请选择字体文件路径。",
    validateRangeSingle: "字符范围起止必须是单个字符。",
    validateRangeOrder: "字符范围起始不能大于结束。",
    validateFallbackSingle: "Fallback 字符必须是单个字符。",
    validateSizeRange: "字号(px)建议在 4~128 范围内。",
    validateModuleName: "模块名不能为空。",
    validateExportName: "导出名不能为空。",
    validateSaveFileName: "保存文件名不能为空。",
    validateThresholdRange: "阈值必须在 0~255 之间。",
    validateGammaRange: "Gamma 建议在 0~5 之间。",
    validateOversampleRange: "Oversample 建议在 1~4 之间。",
    generatorNeedSystemFont: "请选择系统字体",
    generatorNeedFontFile: "请选择字体文件路径",
    generateFailed: "生成失败",
    exportFailed: "导出失败",
} as const;

export type I18nKey = keyof typeof zh;

const en: Record<I18nKey, string> = {
    headerFont: "Font Builder",
    headerImage: "Image Tools",
    headerSine: "Sine Generator",
    headerSevenSeg: "7-Seg Tools",
    menuFont: "Font",
    menuImage: "Image",
    menuSine: "Sine",
    menuSevenSeg: "7-Seg",
    loading: "Loading...",
    imageTodo: "Image tools coming soon.",
    sineTodo: "Sine generator coming soon.",
    sevenSegTodo: "Seven-seg tools coming soon.",
    saveSettingsTitle: "Save Settings",
    saveSettingsConfigName: "Config Name",
    saveSettingsConfigNameRequired: "Please enter a config name",
    saveSettingsSaveDir: "Save Directory",
    saveSettingsChoose: "Browse",
    saveSettingsRememberPath: "Remember path",
    saveSettingsIncludeOptions: "Include build options",
    saveSettingsOk: "OK",
    saveSettingsCancel: "Cancel",
    saveSettingsSuccess: "Saved",
    saveSettingsFail: "Save failed: {msg}",
    saveSettingsUiSection: "UI Settings",
    saveSettingsTheme: "Theme",
    saveSettingsThemeLight: "Light",
    saveSettingsThemeDark: "Dark",
    saveSettingsLanguage: "Language",
    languageZh: "Chinese",
    languageEn: "English",
    generatePreview: "Generate Preview",
    copy: "Copy",
    save: "Save",
    copySuccess: "Copied to clipboard",
    saveSuccess: "Saved: {path}",
    loadFailed: "Load failed: {msg}",
    statusLabel: "Status",
    statusIdle: "Idle",
    statusGenerating: "Generating",
    statusSuccess: "Success",
    statusError: "Error",
    statsGlyphs: "Glyphs",
    statsRanges: "Ranges",
    statsBitmapBytes: "Bitmap bytes",
    statsTextBytes: "Text bytes",
    statsMaxW: "Max width",
    statsMaxH: "Max height",
    statsLineHeight: "Line height",
    statsBaseline: "Baseline",
    statsNoOutput: "No output yet",
    statsEmpty: "No stats yet (generate preview first)",
    statsWarnings: "Warnings",
    tabPreview: "Preview",
    tabCode: "Code",
    tabStats: "Stats",
    leftFontSelect: "Font",
    leftCharset: "Charset",
    leftSize: "Size & Pixels",
    leftProcessing: "Processing",
    leftOutput: "Build Options",
    fontSource: "Font source",
    fontSourceSystem: "System",
    fontSourceFile: "File",
    systemFontLabel: "System font",
    systemFontLoading: "Loading...",
    systemFontSelect: "Select a system font",
    systemFontHint: "List system fonts by name (internally uses file path).",
    filePathLabel: "File path",
    filePathPlaceholder: "Select a .ttf/.otf file",
    chooseFile: "Choose file",
    sizeLabel: "Size (px height)",
    sizeHint: "Pixel hint: 5x7 ~ size 8; 8x16 ~ size 16 (more guidance later)",
    sizeLineHeight: "Line height",
    sizeBaseline: "Baseline",
    processBinarizeMode: "Binarize mode",
    processModeMask: "Python style (1-bit mask)",
    processModeGamma: "Gamma + Oversample",
    processThreshold: "Gray filter strength",
    processAdvanced: "Advanced (Gamma / Oversample)",
    processGamma: "Gamma",
    processOversample: "Oversample",
    outputType: "Output type",
    outputCppModule: "C++20 Module (cppm)",
    outputCppTodo: "C++ (TODO)",
    outputCTodo: "C (TODO)",
    moduleNameLabel: "Module name",
    exportNameLabel: "Export name",
    applySuggestedNames: "Generate default names from font",
    withCommentsLabel: "Generate comments (e.g. // code 33 ('!'))",
    numberFormatLabel: "Bitmap format:",
    numberFormatBin: "Binary",
    numberFormatDec: "Decimal",
    numberFormatHex: "Hex",
    charsetRangeLabel: "Range (single chars)",
    charsetTo: "to",
    charsetCodepointRange: "Codepoints: {start} - {end}",
    charsetCustomLabel: "Custom chars (merged & deduped)",
    charsetCustomPlaceholder: "e.g. ℃★Hello",
    charsetFallbackLabel: "Fallback char (when missing)",
    charsetTodo: "TODO: show final count, duplicates, codepoint list",
    previewScaleLabel: "Scale",
    previewEmpty: "No preview yet",
    previewRaw: "Raw",
    previewGray: "Gray",
    previewMono: "Mono",
    codePreviewPlaceholder: "// Click 'Generate Preview' to show output here.",
    dotMatrixTodoTitle: "TODO: Dot-matrix renderer",
    mockWarning: "Dot-matrix preview not implemented (TODO)",
    validateSystemFont: "Please select a system font.",
    validateFontFile: "Please select a font file path.",
    validateRangeSingle: "Range start/end must be a single character.",
    validateRangeOrder: "Range start must be <= end.",
    validateFallbackSingle: "Fallback must be a single character.",
    validateSizeRange: "Size(px) should be between 4 and 128.",
    validateModuleName: "Module name cannot be empty.",
    validateExportName: "Export name cannot be empty.",
    validateSaveFileName: "Save filename cannot be empty.",
    validateThresholdRange: "Threshold must be between 0 and 255.",
    validateGammaRange: "Gamma should be between 0 and 5.",
    validateOversampleRange: "Oversample should be between 1 and 4.",
    generatorNeedSystemFont: "Please select a system font",
    generatorNeedFontFile: "Please select a font file path",
    generateFailed: "Generate failed",
    exportFailed: "Export failed",
};

const dictionaries: Record<Language, Record<I18nKey, string>> = { zh, en };

export function t(language: Language, key: I18nKey, vars?: Record<string, string | number>): string {
    const template = dictionaries[language]?.[key] ?? zh[key] ?? key;
    if (!vars) return template;
    return template.replace(/\{(\w+)\}/g, (_, name) => {
        const value = vars[name];
        return value == null ? "" : String(value);
    });
}
